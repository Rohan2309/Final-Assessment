<%- include("../partials/header") %>

<style>
  body {
    background: #f8fafc;
  }

  /* Filter Container */
  .filter-box {
    background: white;
    padding: 18px;
    border-radius: 15px;
    border: 1px solid #e2e8f0;
    box-shadow: 0 4px 20px rgba(0,0,0,0.05);
  }

  .form-select,
  .form-control {
    border-radius: 10px;
    border: 1px solid #cbd5e1;
    padding: 12px;
  }

  /* Product Cards */
  .product-card {
    background: #ffffff;
    border-radius: 16px;
    border: 1px solid #e2e8f0;
    box-shadow: 0 4px 18px rgba(0,0,0,0.05);
    transition: transform .15s ease, box-shadow .15s ease;
  }

  .product-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 26px rgba(0,0,0,0.08);
  }

  .product-card img {
    border-radius: 16px 16px 0 0;
  }

  .product-card h5 {
    font-weight: 600;
    color: #334155;
  }

  .product-card p {
    margin-bottom: 10px;
    font-size: 0.9rem;
    color: #64748b;
  }

  .btn-primary {
    background: #a5b4fc;
    border: none;
    border-radius: 10px;
    padding: 8px 16px;
    font-weight: 600;
  }

  .btn-primary:hover {
    background: #818cf8;
  }

</style>

<!-- FILTER SECTION -->
<div class="row mb-4">
  <div class="col-md-3">
    <div class="filter-box">

      <form method="GET" action="/">
        <!-- Category Dropdown -->
        <select name="category" class="form-select mb-3" onchange="this.form.submit()">
          <option value="">All Categories</option>
          <% categories.forEach(c=> { %>
            <option 
              value="<%= c._id %>" 
              <%= (c._id.toString() === category.toString()) ? "selected" : "" %>>
              <%= c.name %>
            </option>
          <% }) %>
        </select>

        <!-- Search Box -->
        <input 
          type="text" 
          name="search" 
          class="form-control" 
          placeholder="Search products..."
          value="<%= search || '' %>"
        >
      </form>

    </div>
  </div>
</div>

<!-- PRODUCT GRID -->
<div class="row">
  <% products.forEach(p => { %>
    <div class="col-md-3 mb-4">
      <div class="product-card">
        
        <!-- Product Image -->
        <img 
          src="/<%= p.image %>" 
          class="card-img-top" 
          style="height:220px; object-fit:cover;"
        >

        <div class="card-body">
          <h5><%= p.name %></h5>
          <p><%= p.category?.name %></p>

          <a href="/product/<%= p.slug %>" class="btn btn-primary btn-sm">
            View
          </a>
        </div>

      </div>
    </div>
  <% }) %>
</div>

<%- include("../partials/footer") %>
